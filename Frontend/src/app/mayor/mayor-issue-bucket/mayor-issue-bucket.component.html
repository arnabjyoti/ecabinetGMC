<app-sidebar (collapsedChange)="onSidebarToggle($event)"></app-sidebar>

<div class="main-content" [class.collapsed]="sidebarCollapsed">
  <h3
    class="page-title"
    style="margin-top: 50px; text-align: center; color: rgb(87, 90, 92)"
  >
    AGENDA BUCKET
  </h3>

  <div class="mail-container">
    <!-- Sidebar -->
    <div class="sidebar">
      <div
        class="menu"
        [class.active]="activeTab === 'inbox'"
        (click)="selectTab('inbox')"
      >
        <i class="bi bi-inbox"></i> &nbsp; Agenda Inbox&nbsp;
        <span class="count" style="float: right">{{
          issues.inbox.length
        }}</span>
      </div>

      <div
        class="menu"
        [class.active]="activeTab === 'sent'"
        (click)="selectTab('sent')"
      >
        <i class="bi bi-send"></i> &nbsp;Selected for MIC &nbsp;
        <span class="count" style="float: right">{{ issues.sent.length }}</span>
      </div>
    </div>
    <!-- Content -->
    <div class="content" *ngIf="!isDetailView">
      <h3>
        <i *ngIf="activeTab == 'inbox'" class="bi bi-inbox"></i
        ><i *ngIf="activeTab == 'sent'" class="bi bi-send"></i
        >&nbsp;{{ activeTab == "inbox" ? "Agenda Inbox" : "Selected for MIC"
        }}<button
          *ngIf="activeTab == 'sent' && !isVotingStarted && issues.sent.length>0"
          (click)="startVoting()"
          class="btn btn-primary px-4"
          style="float: right; background-color: green"
        >
          <i class="bi bi-hand-thumbs-up"></i> Start Meeting
        </button>
        <button
          *ngIf="activeTab == 'sent' && isVotingStarted && issues.sent.length>0"
          (click)="stopVoting()"
          class="btn btn-primary px-4"
          style="float: right; background-color: brown"
        >
          <i class="bi bi-x-square"></i> Stop Meeting
        </button>
      </h3>
      <div class="mail-list" *ngIf="issues[activeTab]?.length; else noIssue">
        <div *ngFor="let issue of issues[activeTab]">
          <div
            class="mail-item"
            style="cursor: pointer"
            (click)="onView(issue)"
          >
            <div class="mail-from">{{ issue.from || issue.to || "Draft" }}</div>
            <div class="mail-subject">{{ issue.subject }}</div>
            <div class="mail-time">{{ issue.time }}</div>
          </div>
        </div>
      </div>

      <ng-template #noIssue>
        <div class="no-issues-container">
          <img
            src="assets/image/no-issues.jpg"
            alt="No issues available"
            class="no-issues-image"
          />
          <h3>No Agendas Available</h3>
          <p>Youâ€™re all caught up! There are currently no agendas to display.</p>
        </div>
      </ng-template>
    </div>
    <div class="content" *ngIf="isDetailView">
      <h4>
        <strong
          ><a href="javascript:;" (click)="onBack()"
            ><i class="bi bi-arrow-left"></i> </a
          >&nbsp;{{ selectedIssue?.title }}</strong
        >
      </h4>
      <app-issue-details
        [issue]="selectedIssue"
        [activeTab]="activeTab"
        [user]="user"
        (onSent)="onSent($event)"
      ></app-issue-details>
    </div>
  </div>
</div>

<ngx-spinner
  bdColor="rgba(51,51,51,0.8)"
  size="medium"
  color="#fff"
  type="ball-spin-clockwise"
  style="background-color: aliceblue"
>
  <p style="color: white">
    <i
      class="fa fa-circle-o-notch fa-spin fa-4x text-danger"
      aria-hidden="true"
    ></i
    >Loading...Please Wait
  </p>
</ngx-spinner>
